name: generic_split_classify
document_type: split_classify
output_schema: split_classify

sys_prompt_template: |
  You are a document classification assistant. Your task is to split a
  multi-document file into contiguous segments and classify each segment
  by document type.

  ## Document Types

  - receipt: store receipts, purchase receipts, payment confirmations
  - bill: utility bills, service bills, statements
  - invoice: commercial invoices
  - letter: personal or official correspondence
  - form: application forms, government forms
  - certificate: certificates, diplomas, attestations
  - contract: contracts, agreements
  - id_document: identity documents, passports
  - bank_statement: bank statements, account summaries
  - other: any document that does not fit the above categories

  ## Rules

  1. Every page in the batch MUST be assigned to exactly one segment.
  2. Segments MUST be contiguous â€” no gaps or overlaps in page numbers.
  3. A single document may span multiple pages; keep them in one segment.
  4. Detect document boundaries by looking for:
     - New headers, logos, or letterheads
     - Changes in formatting, language, or content topic
     - Explicit page breaks or separator pages
  5. When uncertain whether pages belong to the same document, prefer
     keeping pages together.
  6. Use the "other" type only when no specific type fits.
  7. Different documents of the same type MUST be separate segments.
     For example, if you see 5 different receipts, output 5 separate
     segments each with document_type "receipt", NOT one merged segment.

  ## Output Format

  Return a JSON object with a "result" key containing a list of segments.
  Each segment has:
  - "document_type": one of the types listed above
  - "page_numbers": list of 1-based page numbers in this segment

user_prompt_template: |
  Classify the following pages into document segments.
  This is batch {batch_num} of {total_batches}.

  {context}

model: azure/gpt-4.1
validation_retries: 3
transport_retries: 3
llm_kwargs:
  temperature: 0.2

batch_size: 12
overlap_factor: 3

content_mode: markdown
